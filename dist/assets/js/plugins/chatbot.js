import{storage}from"./firebase.js";import{ref,uploadString}from"https://www.gstatic.com/firebasejs/9.6.9/firebase-storage.js";jQuery(document).ready((function(s){jQuery(document).on("click",".iconInner",(function(e){jQuery(this).parents(".botIcon").addClass("showBotSubject"),i("1"),s("[name='msg']").focus()})),jQuery(document).on("click",".closeBtn, .chat_close_icon",(function(t){jQuery(this).parents(".botIcon").removeClass("showBotSubject"),jQuery(this).parents(".botIcon").removeClass("showMessenger"),n=[],e=0,s(".Messages_list").empty()})),jQuery(document).on("click",".chat_reset_icon",(function(t){console.log(e),n.pop(),console.log(n),s(`.msg.ptr-${e}`).remove(),e>0?e--:0==e&&i("1"),s(".Messages_list").fadeOut(150).fadeIn(150)})),jQuery(document).on("click",".botOption",(function(a){var p,l,r;p=a.target.id.split("-")[0],l=a.target.id.split("-")[1],new Audio("./assets/notification.mp3").play(),e++,function(t){s(".Messages_list").append(`<div class="msg user ptr-${e}"><span class="avtr"><img src="./assets/images/user/user.png" style="height:25px"/></span><span class="responsText">${t}</span></div>`)}(t[p].options[l].option_text),n.push({question:t[p].question_text,option:t[p].options[l].option_text}),console.log(n),t[p].options[l].isEndNode?(r=t[p].options[l].final_answer,s(".Messages_list").append(`<div class="msg ptr-${e}"><span class="avtr"><img src="./assets/images/favicon.png" style="height:25px"/></span><span class="responsText">${r}</span></div>`),s("[name='msg']").val(""),n.push({finalResponse:t[p].options[l].final_answer}),s(".Messages_list").append(`<div class="msg ptr-${e}"><span class="avtr"><img src="./assets/images/favicon.png" style="height:25px"/></span><span class="responsText">Thank you for contacting us. If this didn't resolve your query then please fill the following details - <div><form><label for="t11">Your query</label><textarea class="finalInputField" id="t11" name="finalInput" required></textarea><label for="t12">Your email address</label><input class="finalInput" type="email" id="t12" name="emailInput" required></input><label for="t13">Your name</label><input class="finalInput mb-3" type="text" id="t13" name="nameInput" required></input><div class="sendButtonDiv"><button class="sendButton">Send</button></div></div></form></span>`),o()):i(t[p].options[l].follow_up)})),jQuery(document).on("submit","#botSubject",(function(s){s.preventDefault(),jQuery(this).parents(".botIcon").removeClass("showBotSubject"),jQuery(this).parents(".botIcon").addClass("showMessenger")})),jQuery(document).on("click",".sendButton",(function(s){s.preventDefault();let e=jQuery(this).parent().siblings("#t11").val(),t=jQuery(this).parent().siblings("#t12").val(),n=jQuery(this).parent().siblings("#t13").val();const i=Date.now(),a=ref(storage,`${t}_${n}_${i.toString()}.txt`),p=`Query - ${e}\nTrace - \n${o()}`;uploadString(a,p).then((s=>{console.log("Uploaded query!")}))}));var e=0,t={1:{question_text:"Welcome to Kinetic Codes. Are you looking for ...?",options:[{option_text:"App Development",follow_up:"2",isEndNode:!1},{option_text:"Game Development",follow_up:"2",isEndNode:!1},{option_text:"Dev-Ops",final_answer:"We don't provide this service as of now.",isEndNode:!0}]},2:{question_text:"Is this ...?",options:[{option_text:"Frontend",follow_up:"3",isEndNode:!1},{option_text:"Backend",final_answer:"This is a final response",isEndNode:!0}]},3:{question_text:"This is ...",options:[{option_text:"Final Response",final_answer:"This is a final response",isEndNode:!0}]}},n=[];function o(){var s="";return n.forEach(((e,t)=>{t==n.length-1?s+=`Final Response - ${e.finalResponse}`:s+=`${t+1}. ${e.question} - ${e.option}\n`})),console.log(s),s}function i(n){var o;o=t[n].question_text,s(".Messages_list").append(`<div class="msg ptr-${e}"><span class="avtr"><img src="./assets/images/favicon.png" style="height:25px"/></span><span class="responsText">${o}</span></div>`),t[n].options.forEach(((t,o)=>{var i,a,p;i=t.option_text,a=n,p=o,s(".Messages_list").append(`<div class="msg ptr-${e}"><button class="responsText botOption" id='${a}-${p}'>${i}</button></div>`)}))}}));